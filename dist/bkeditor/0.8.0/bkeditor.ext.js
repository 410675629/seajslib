/*! Bkeditor - v0.8.0 - 2013-05-24
* https://github.com/daixianfeng/a
* Copyright (c) 2013 daixianfeng; Licensed MIT */
(function(e,t){e.addUi({id:"imagedialog",submit:function(){var e=t("#imagedialog");if(0!==e.size()){var n=e.find("#src").val(),i=e.find("#link").val(),r=e.find("#target").val(),o=e.find("#width").val(),a=e.find("#height").val(),l='<a href="'+i+'" target="'+r+'"><img src="'+n+'" style="width:'+o+";height:"+a+';"/></a>';return l}return!1},changecolor:function(n){return t("#imagedialog"),e.coreCommand.editText("color",n),!1}}),t("#imagedialog").find("[name=link]").live("mouseenter",function(){alert("innerScript test -- mouseover")})})(window.jQuery.jQEditor,window.jQuery),function(e,t){e.addUi({id:"linkdialog",submit:function(){var n=t("#linkdialog");if(0===n.size())return!1;var i=n.find("#text").val(),r=n.find("#link").val(),o=n.find("#target").val(),a='<a  href="'+r+'" target="'+o+'">'+i+"</a>";e.utils.pasteHTML(a)}})}(window.jQuery.jQEditor,window.jQuery),function(e){e.addUi({id:"mapdialog",submit:function(t){var n=$("#mapdialog");if(0===n.size())return!1;var i=t.Main,r=(i.geocoder,i.map),o=r.getCenter().lat()+","+r.getCenter().lng(),a=i.marker?i.marker.position:o,l=r.getZoom(),s=r.getMapTypeId(),c="http://maps.google.com/maps/api/staticmap?center="+o+"&zoom="+l+"&size=520x340"+"&maptype="+s+"&markers="+a+"&language=zh-cn"+"&sensor=false",d='<img class="googlemap" src="'+c+'" title="'+i.address+'" alt="'+i.address+'"/>';e.utils.pasteHTML(d)}})}(window.jQuery.jQEditor),function(e,t){e.addUi({id:"pasteworddialog",submit:function(){var n=t("#pasteworddialog");if(0===n.size())return!1;var i=n.find("#content").val();e.utils.pasteHTML(i)}})}(window.jQuery.jQEditor,window.jQuery),function(){}(jQuery.jQEditor,jQuery),function(e,t){e.addUi({id:"tabledialog",submit:function(){var n=t("#tabledialog");if(0!==n.size()){var i=n.find("[name=title]")[0].checked,r=n.find("[name=col]").val(),o=n.find("[name=row]").val(),a=n.find("[name=float]:checked").val(),l=n.find("[name=head]")[0].checked,s=e.utils.execPlugin("table","preInsert",{title:i,head:l,col:r,row:o,"float":a});return s}return!1},changeAttr:function(){var n=t("#tableattrdialog");if(0===n.size())return!1;var i=n.find("[name=title]")[0].checked,r=n.find("[name=col]").val(),o=n.find("[name=row]").val(),a=n.find("[name=float]:checked").val(),l=n.find("[name=head]")[0].checked;e.utils.execPlugin("table","changeTableAttr",{title:i,head:l,col:r,row:o,"float":a})},setValues:function(e){var n=t("#tableattrdialog:visible");n.length>0&&(n.find("[name=float][value="+e.float+"]")[0].checked=!0,n.find("[name=title]")[0].checked=e.title?!0:!1,n.find("[name=head]")[0].checked=e.head?!0:!1,e.row&&n.find("[name=row]").val(e.row),n.find("[name=row]")[0].disabled=!0,e.col&&n.find("[name=col]").val(e.col),n.find("[name=col]")[0].disabled=!0)}})}(window.jQuery.jQEditor,window.jQuery),function(e,t){function n(e){if(this.html="",e)for(var t in e)this[t]=e[t]}function i(t){function i(e){n.call(this,e)}try{if(t.id){var r=t.id;i.prototype=c,e.uiList[r]=new i(t),e.uiList[r].initUi(),e.trigger("afterUi")}}catch(o){e.error.writeError(t.id+" ui add error: "+o.message,3,"ui")}}var r=e.config.cCommand,o={};for(var a in r.uiCommand){var l=r.uiCommand[a],s=l.cmd.replace("dialog","");o[l.cmd]={isEnable:!0,scriptAddr:e.config.cUi.addr+s+"/"+s+".dialog.js"}}e.loadUi=function(t,n){var i=o[t].scriptAddr;e.load.loadOneFile(i,function(){n()})},n.prototype={initUi:function(){this.allList=o},submit:function(){return!1},cancel:function(){return!1},getHtml:function(){return this.html},getValues:function(){var e={},n=t("#"+this.id+" :input");return n.each(function(){e[this.name]=t(this).val()}),e},setValues:function(e){var n=t("#"+this.id+" :input");n.each(function(){t(this).val(e[this.name])})},hide:function(){},enable:function(){this.isEnable=!0},disable:function(){this.isEnable=!1},writeLog:function(t){var n="The operate "+t+" !",i="ui",r=new Date,o=r.toLocaleString();e.log.writeLog(n,i,o)},writeError:function(t,n){var i="The operate "+t+" error !",r="ui",o=new Date,a=o.toLocaleString();e.error.writeError(i,n,r,a)},showTips:function(t){var n="";t||(t=this.tips),n=e.lang.UiTips[t]?e.lang.UiTips[t]:t,e.utils.showTips(n)}};var c=new n;c.initUi(),i.ready=!0,e.addUi=i}(window.jQuery.jQEditor,window.jQuery),function(e,t){e.addUi({id:"videodialog",submit:function(){var n=t("#videodialog");if(0==n.size())return!1;var i=n.find("#src").val(),r=n.find("#width").val(),o=n.find("#height").val(),a='<embed src="'+i+'" quality="high" width="'+r+'" height="'+o+'" align="middle" allowScriptAccess="sameDomain" allowFullscreen="true" type="application/x-shockwave-flash"></embed>';e.utils.pasteHTML(a)}})}(window.jQuery.jQEditor,window.jQuery),function(e){e.dialogHtml.imagedialog='<TABLE ui="imagedialog"><TR><TD>图片地址</TD><TD><input type="text" id="src" name="src" /></TD><TD><select id="align" name="align"><option value="left" selected="selected">左对齐</option><option value="right">右对齐</option></select></TD></TR><TR><TD>图片链接</TD><TD><input type="text" id="link" name="link"/></TD><TD><select id="target" name="target"><option value="_blank" selected="selected">新窗口</option><option value="_top">当前窗口</option></select></TD></TR><TR><TD>图片宽</TD><TD><input type="text" id="width" name="width"/></TD><TD>&nbsp;</TD></TR><TR><TD>图片高</TD><TD><input type="text" id="height" name="height"/></TD><TD>&nbsp;</TD></TR><TR><TD>图片高</TD><TD><input type="button" id="changecolor" name="changecolor" cmd="changecolor" param="blue" value="ui format demo"/></TD><TD>&nbsp;</TD></TR></TABLE>'}(window.jQuery.jQEditor),function(e){e.dialogHtml.tabledialog='<TABLE ui="tabledialog"><TR><TD>表格模板</TD><TD><select id="table-template" name="template"><option value="tpl1" selected="selected">模板1</option><option value="tpl2">模板2</option></select></TD><TD> &nbsp </TD></TR><TR><TD>表格标题</TD><TD><input type="checkbox" id="table-title" name="title" /></TD></TR><TR><TD>表头</TD><TD><input type="checkbox" id="table-head" name="head" /></TD><TD> &nbsp </TD></TR><TR><TD>行</TD><TD><input type="text" id="table-col" name="row" value="4"/></TD><TD> &nbsp </TD></TR><TR><TD>列</TD><TD><input type="text" id="table-row" name="col" value="3"/></TD><TD> &nbsp </TD></TR><TR><TD>浮动方式</TD><TD><p><input type="radio" id="table-float-left" name="float" value="1"/>左浮动<input type="radio" id="table-align-center" name="float" checked="checked" value="2"/>居中<input type="radio" id="table-align-right" name="float" value="3"/>右浮动</p></TD><!--<TD><p><input type="radio" id="table-align-lt" name="align" value="1"/>居左上<input type="radio" id="table-align-ct" name="align" value="2"/>居中上<input type="radio" id="table-align-rt" name="align" value="3"/>居右上</p><p><input type="radio" id="table-align-lm" name="align" value="4"/>居左中<input type="radio" id="table-align-cm" name="align" checked="checked" value="5"/>居&nbsp&nbsp中<input type="radio" id="table-align-rm" name="align" value="6"/>居右中</p><p><input type="radio" id="table-align-lb" name="align" value="7"/>居左下<input type="radio" id="table-align-cb" name="align" value="8"/>居中下<input type="radio" id="table-align-rb" name="align" value="9"/>居右下</p></TD>  --><TD> &nbsp </TD></TR></TABLE>'}(window.jQuery.jQEditor),function(e){e.addUi({id:"aboutdialog",html:'<p><strong style="color:blue;">version</strong> : 0.7.0</p><p style="text-indent:2em;">编辑器正处于开发阶段，欢迎各种意见及建议</p><p><strong style="color:blue;">快捷键</strong></p><p style="text-indent:2em;">1,	ctrl+a : 全选</p><p style="text-indent:2em;">2,	ctrl+c : 复制</p><p style="text-indent:2em;">3,	ctrl+x : 剪切</p><p style="text-indent:2em;">4,	ctrl+v : 粘贴</p><p style="text-indent:2em;">5,	ctrl+z : 撤销</p><p style="text-indent:2em;">6,	ctrl+y : 重做</p><p style="text-indent:2em;">7,	ctrl+s : 保存</p>'}),e.addPlugin({id:"about",title:"关于",ui:"aboutdialog",type:"dialog"})}(jQuery.jQEditor,jQuery),function(e,t){e.addUi({id:"anchordialog",html:'<div style="width:350px;padding:10px;">锚点名称：<input name="name" style="width:200px;height:20px;"/></div>',submit:function(){var e=t("#anchordialog").find("input[name=name]").val();return'<img name="'+e+'" title="'+e+'" class="bke-anchor"/>'}}),e.addPlugin({id:"anchor",title:"锚点",ui:"anchordialog",type:"dialog"})}(jQuery.jQEditor,jQuery),function(e,t){function n(e){e.children().eq(0).size()&&(e=e.children().eq(0),e.html(e.html().replace(r,"")),n(e))}function i(e){for(var i,o=t("body",e)[0].childNodes,a=0,l=o.length;l>a;a++)if(i=o[a],1===i.nodeType){var s=t(i);/^(p|h2|h3)$/i.test(i.nodeName)&&(s.html(s.html().replace(r,"a")),n(s))}}var r=/^(\s|&nbsp;|　)+/i;e.addPlugin({id:"autoformat",click:function(){i(e.editDom)}})}(jQuery.jQEditor,jQuery),function(e){e.addPlugin({id:"baikelink",isEnable:!0,linkName:"baikelink",click:function(){var t=this,n="http://www.baike.com/wiki/",i="",r=e.utils.getSelectionText();return r?r.length>80?e.errorMessage("百科链接，不能选择超过80个字符的长度！"):/[`~!\\\/]/.test(r)?e.errorMessage("百科链接，不能包含特殊字符“`~!/”！"):(i='<a href="'+n+encodeURIComponent(r)+'" class="'+t.linkName+'" title="'+r+'" target="_blank">'+r+"</a>",e.utils.pasteHTML(i)):e.errorMessage("请选择需要设置为百科链接的文字！"),1}})}(window.jQuery.jQEditor),function(e,t){e.addPlugin({id:"blockquote",title:"引用",click:function(){var n=e.curEditor,i=n.getCursorElement(),r=[],o=null;t.each(DTD.$block,function(e){r.push(e)}),o=t(i).closest(r.join(",")),n.insert('<a id="__cursor">&#8203;</a>'),o.parent().is("blockquote")?o.unwrap():o.wrap("<blockquote></blockquote>");var a=t("#__cursor",n.dom);e.utils.setCursor(n.win,a[0]),a.remove()}})}(jQuery.jQEditor,jQuery),function(e,t){e.addPlugin({id:"cleardoc",title:"清空文档",isEnable:!0,click:function(){if(confirm("确定要删除当前所有内容吗？")){var n=e.get("body"),i=e.get("editor"),r=i.dom.createElement("p");r.innerHTML="&#8203;",t(n).empty().append(r),e.utils.setCursor(i.win,r,!0)}}})}(jQuery.jQEditor,jQuery),function(e,t){function n(n){n=n.replace(/\n+/g,"");var i=t("<div></div>").append(n),r="",o=null;i.children().each(function(){try{o=t(this),r=o.html(),r.length>50&&o.html("\n"+r+"\n"),o.after("\n")}catch(e){}});var a=i.find("table");return a.size()&&a.find("tr,td,th").after("\n").before("\n"),n=i.html(),n=n.replace(/\n+/g,"\n"),n=n.replace(/<BR>/gi,"<br>\n"),n=n.replace(/<.+?>/gi,function(e){return e=e.replace(/COLOR:/g,"color:"),e=e.replace(/rgb\(\d+,(?: |&nbsp;)?\d+,(?: |&nbsp;)?\d+\)/gi,function(e){return Utils.colorToHex(e)})}),e.IE&&(n=n.replace(/<(\w+)/gi,function(e,t){return"<"+t.toLowerCase()}),n=n.replace(/(\w+)>/gi,function(e,t){return t.toLowerCase()+">"})),n}var i,r="",o=!1;e.addPlugin({id:"codemirror",title:"源代码",click:function(){var a=e.curEditor,l=t("#"+a.Eid+" textarea"),s="";o?(s=i.getValue(),a.setContent(s),t(".CodeMirror").remove(),t("#"+a.Eid+" iframe").show(),o=!1,this.clicked(!1),r&&e.utils.setSelectionByOffset(e.editWin,r),r=""):(r=e.utils.getSelectionOffset(a.win),this.clicked(!0),s=n(a.getContent()),l.val(s),t("#"+a.Eid+" iframe").hide(),i=CodeMirror.fromTextArea(l[0],{mode:{name:"xml",alignCDATA:!0},lineNumbers:!0,lineWrapping:!0,tabMode:"indent"}),o=!0,t(".CodeMirror").height("100%"))}})}(jQuery.jQEditor,jQuery),function(e,t){function n(e,t,n){for(var i="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(","),r='<div id="##" class="edui-colorpicker"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" >'+e+"</div>"+"</div>"+'<table  class="edui-box" style="border-collapse: collapse;" cellspacing="0" cellpadding="0">'+'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+n.getLang("themeColor")+"</td> </tr>"+'<tr class="edui-colorpicker-tablefirstrow" >',o=0;i.length>o;o++)o&&0===o%10&&(r+="</tr>"+(60==o?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+n.getLang("standardColor")+"</td></tr>":"")+"<tr"+(60==o?' class="edui-colorpicker-tablefirstrow"':"")+">"),r+=70>o?'<td style="padding: 0 2px;"><a hidefocus cmd="'+t+'" title="'+i[o]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell"'+' param="#'+i[o]+'"'+' style="background-color:#'+i[o]+";border:solid #ccc;"+(10>o||o>=60?"border-width:1px;":o>=10&&20>o?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"'+"></a></td>":"";return r+="</tr></table></div>"}e.addPlugin({id:"colormenu",type:"panel",isEnable:!0,fill:function(){e.fillPanel("forecolormenu",n("清除颜色","forecolor",e)),e.fillPanel("backcolormenu",n("清除颜色","backcolor",e)),e.fillPanel("cellcolormenu",n("清除颜色","cellcolor",e))},forecolor:function(){e.toolbar.togglePanel("forecolormenu")},backcolor:function(){e.toolbar.togglePanel("backcolormenu")},cellcolor:function(){e.toolbar.togglePanel("cellcolormenu")},getCellcolorPicker:function(){return n("清除颜色","cellcolor",e)}}),t(document).delegate(".edui-box td a","mouseenter",function(){var e=t(this),n=t(".edui-colorpicker-preview");n.css({"background-color":e.attr("param")})}),t(document).delegate(".edui-box td a","mouseleave",function(){var e=(t(this),t(".edui-colorpicker-preview"));e.css({"background-color":""})})}(window.jQuery.jQEditor,window.jQuery),function(e){function t(e){"string"==typeof e&&e||(e="Y-m-d");var t=new Date,n={};return n.Y=t.getFullYear(),n.m=t.getMonth()+1,n.d=t.getDate(),e.replace("Date_","").replace("Y",n.Y).replace("m",n.m).replace("d",n.d)}e.addPlugin({id:"datemenu",type:"panel",isEnable:!0,fill:function(t){var n="",i=[{name:"Y-m-d",cmd:"insertdate",param:"type_1"},{name:"Y/m/d",cmd:"insertdate",param:"type_2"},{name:"Y.m.d",cmd:"insertdate",param:"type_3"},{name:"Y年m月d日",cmd:"insertdate",param:"type_4"}];n=e.Menu.create(i),e.fillPanel("datemenu",n,t)},type_1:function(){e.utils.pasteHTML(t("Y-m-d"))},type_2:function(){e.utils.pasteHTML(t("Y/m/d"))},type_3:function(){e.utils.pasteHTML(t("Y.m.d"))},type_4:function(){e.utils.pasteHTML(t("Y年m月d日"))}})}(window.jQuery.jQEditor),function(e,t){e.addPlugin({id:"element",isEnable:!0,click:function(){for(var n=t("#"+e.curId+" .bke-elementpath"),i=e.utils.getCurElement(),r=[],o=0,a=i.length;a>o;o++)3!==i[o].nodeType&&r.push("<a>"+i[o].nodeName.toLowerCase()+"</a>");n.html("元素路径："+r.join("&gt;"))}})}(jQuery.jQEditor,jQuery),function(e,t){var n=[{name:"宋体",cmd:"fontfamily",param:"SimSun",styleName:"bke-SimSun"},{name:"仿宋体",cmd:"fontfamily",param:"FangSong_GB2312",styleName:"bke-FangSong_GB2312"},{name:"微软雅黑",cmd:"fontfamily",param:"Microsoft YaHei",styleName:"bke-Microsoft_YaHei"},{name:"黑体",cmd:"fontfamily",param:"SimHei",styleName:"bke-SimHei"},{name:"楷体",cmd:"fontfamily",param:"KaiTi_GB2312",styleName:"bke-KaiTi_GB2312"},{name:"Impact",cmd:"fontfamily",param:"Impact",styleName:"bke-Impact"},{name:"Georgia",cmd:"fontfamily",param:"Georgia",styleName:"bke-Georgia"},{name:"Arial",cmd:"fontfamily",param:"Arial",styleName:"bke-Arial"},{name:"Verdana",cmd:"fontfamily",param:"Verdana",styleName:"bke-Verdana"},{name:"Tahoma",cmd:"fontfamily",param:"Tahoma",styleName:"bke-Tahoma"}];e.addPlugin({id:"fontfamilymenu",type:"panel",isEnable:!0,fill:function(t){var i=e.Menu.create(n);e.fillPanel("fontfamilymenu",i,t)},echo:function(e,i){i=i.replace(/'/g,"")||"",i=i.toLowerCase(),t.each(n,function(t,n){return n.param.toLowerCase()===i?(e.find("#icon-fontfamilymenu").find(".bke-Font a").html(n.name),!1):void 0})}})}(jQuery.jQEditor,jQuery),function(e){var t=[{name:"12px",cmd:"fontsize",param:"12px",styleName:"bke-font12"},{name:"14px",cmd:"fontsize",param:"14px",styleName:"bke-font14"},{name:"18px",cmd:"fontsize",param:"18px",styleName:"bke-font18"},{name:"24px",cmd:"fontsize",param:"24px",styleName:"bke-font24"},{name:"36px",cmd:"fontsize",param:"36px",styleName:"bke-font36"}];e.addPlugin({id:"fontsizemenu",type:"panel",isEnable:!0,fill:function(){var n=e.Menu.create(t);e.fillPanel("fontsizemenu",n)},echo:function(e,t){e.find("#icon-fontsizemenu").find(".bke-FontSize a").html(t)}})}(window.jQuery.jQEditor),function(e,t){var n={html:"HTML/XML",js:"Javascript",css:"CSS",php:"PHP",java:"Java",py:"Python",pl:"Perl",rb:"Ruby",cs:"C#",c:"C++/C",vb:"VB/ASP"},i='<div><select name="code_language" style="margin:2px 0;">';for(var r in n)i+='<option value="'+r+'">'+n[r]+"</option>";i+="</select></div>",i+='<textarea name="content" style="width:600px;height:300px;resize:none;"></textarea>',e.addUi({id:"codedialog",html:i,submit:function(){var n=t("#codedialog"),i=n.find("select[name=code_language]").val(),r=n.find("textarea").val();return r=e.utils.escape(r),'\n<pre class="prettyprint lang-'+i+'">'+r+"</pre>\n"}}),e.addPlugin({id:"highlightcode",title:"源代码",ui:"codedialog",type:"dialog",getData:function(e){var n=e.getCursorElement(),i=t(n).closest("pre").text(),r={content:i};return r}})}(jQuery.jQEditor,jQuery),function(e){e.addPlugin({id:"hn",isEnable:!0,paramStr:function(t){var n="",i=e.utils.getSelectionText();return i?i.length>80?e.log.writeLog("不能选择超过80个字符的长度！"):/[`~!\\\/]/.test(i)?e.log.writeLog("不能包含特殊字符“`~!/”！"):(n="<"+t+' class="'+t+'">'+i+"</"+t+">",e.utils.pasteHTML(n)):e.log.writeLog("请选择需要设置为百科链接的文字！"),1},h2:function(){this.paramStr("h2")},h3:function(){this.paramStr("h3")}})}(window.jQuery.jQEditor),function(e,t){var n=e.config.cCommand,i={browserChecked:{},customChecked:{},browserValue:{},customValue:{},tableChecked:{}};for(var r in n)for(var o in n[r]){var a=n[r][o];""!==a.icon&&(i[a.icon][o]="customChecked"===a.icon||"browserChecked"===a.icon?""===a.param?{tag:a.cmd,state:"_off"}:"pluginCommand"===r?{tag:a.param,state:"_off"}:{style:a.cmd,value:a.param,state:"_off"}:{style:a.cmd,value:a.param,state:"_off"})}var l={tableSelect:{tableprops:"_off",deletetable:"_off"},cellSelect:{cellcolor:"_off",cellcolormenu:"_off",insertcolbefore:"_off",insertcolafter:"_off",insertrowbefore:"_off",insertrowafter:"_off",deletecol:"_off",deleterow:"_off",combinecells:"_off",tableprops:"_off",deletetable:"_off"},cellIn:{cellcolor:"_off",cellcolormenu:"_off",deletecol:"_off",deleterow:"_off",splittocols:"_split",splittorows:"_split",splittocells:"_split",combinecolafter:"_combine",combinerowafter:"_combine",insertcolbefore:"_off",insertcolafter:"_off",insertrowbefore:"_off",insertrowafter:"_off",tableprops:"_off",deletetable:"_off"},tableOut:{inserttable:"_off",inserttablemenu:"_off"}};e.addPlugin({id:"icon",isEnable:!0,click:function(){for(var n,r={},o={},a={},s=e.utils.getCurElement(),c=s.length,d=0;c>d;d++){var u=s[d].nodeName.toLowerCase();if(o[u]=!0,t(s[d]).attr("style"))for(var f=t(s[d]).attr("style").split(";"),m=f.length,p=0;m>p;p++){var g=f[p].split(":");"string"==typeof g[1]&&(a[g[0]]=g[1].replace(/^[ ]+/g,""))}}for(n in i.customChecked){var h=i.customChecked[n].tag,b=i.customChecked[n].style;r[n]=h&&o[h]===!0?"_on":b&&a[b]===i.customChecked[n].value?"_on":"_off","_off"===r.justifycenter&&"_off"===r.justifyright&&(r.justifyleft="_on")}for(n in i.customValue){var b=i.customValue[n].style;r[n]=b&&a[b]?a[b]:i.customValue[n].state}for(n in i.browserChecked)r[n]=e.editDom.queryCommandState(n)===!0?"_on":"_off";for(n in i.browserValue)if(e.editDom.queryCommandValue(n)){if(r[n]=e.editDom.queryCommandValue(n),"ForeColor"===n||"BackColor"===n){var v=/[0-9]+/g,y=r[n].match(v);r[n]="#";for(var d=0;y.length>d;d++){var w=parseInt(y[d],16);128>w&&(r[n]+="0"),r[n]+=w}}}else r[n]=i.browserValue[n].state;var E=t(e.editDom).find("."+e.curEditor.config.selectTableClass).length,C=t(e.editDom).find("."+e.curEditor.config.selectCellClass).length;for(n in i.tableChecked)if(r[n]="_freeze",0!==E)l.tableSelect[n]!==void 0&&(r[n]=l.tableSelect[n]);else if(0!==C)l.cellSelect[n]!==void 0&&(r[n]=l.cellSelect[n]);else if(o.td===!0||o.th===!0){if(l.cellIn[n]!==void 0&&(r[n]=l.cellIn[n]),"_split"===r[n]){var T=t(e.utils.getCurElement().pop()).closest("td,th");r[n]="_freeze",T.attr("colspan")&&(r.splittocols="_off",r.splittocells="_off"),T.attr("rowspan")&&(r.splittorows="_off",r.splittocells="_off")}"_combine"===r[n]&&(r[n]="_freeze",e.utils.execPlugin("table","combineRowAfter",!0)&&(r.combinerowafter="_off"),e.utils.execPlugin("table","combineColAfter",!0)&&(r.combinecolafter="_off"))}else l.tableOut[n]!==void 0&&(r[n]=l.tableOut[n]);var k=e.curEditor.baseHistory;k&&(r.redo=k.redoState?"_off":"_freeze",r.undo=k.revertState?"_off":"_freeze"),e.curEditor.pasteToText===!0&&(r.pastetotext="_on"),e.pluginList.font&&(r.formatmatch=e.pluginList.font.brushOn[e.curId]?"_on":"_off");var x=t("#"+e.curId).find(".bke-toolbar");x.find(".bke-btn").not(":has(.bke-submenu)").removeClass("bke-checked"),x.find(".bke-btn").removeClass("bke-disabled");for(n in r)if("_on"===r[n])x.find("#icon-"+n).closest(".bke-btn").addClass("bke-checked");else if("_freeze"===r[n])x.find("#icon-"+n).closest(".bke-btn").addClass("bke-disabled");else if("_off"===r[n]);else if("backcolor"===n||"forecolor"===n)x.find("#icon-"+n).find("i").css("backgroundColor",r[n]);else if("fontsize"===n||"fontfamily"===n){var _=e.plugin(n+"menu");_&&"function"==typeof _.echo&&_.echo(x,r[n])}}})}(window.jQuery.jQEditor,window.jQuery),function(e){function t(){var t=$(e.editDom).find("."+e.curEditor.config.selectImgClass);return t.length>0?t:$(e.utils.getCurElement().pop()).prev("img")}e.addPlugin({id:"image",type:"dialog",showDialog:function(t){e.utils.loadDialog(this.id,e.config.cUi.addr+"image/",function(){var n=t.Eid;e.dialog.open({id:"imagedialog",editor:n,title:"添加图片",content:$("[ui=imagedialog]"),ok:function(){e.command("imagedialog")},cancel:function(){e.dialog.close("imagedialog")},icon:"succeed"})})},imgFloat:function(e){var n="";switch(e=parseInt(e)){case 1:n="left";break;case 2:n="none";break;case 3:n="right";break;default:n="none"}var i=t();$(i).css("float",n)},preInsert:function(e){return'<a href="'+e.link+'" target="'+e.target+'"><img src="'+e.url+'" style="width:'+e.width+";height:"+e.height+';"/></a>'}})}(window.jQuery.jQEditor),function(e,t){e.addPlugin({id:"insertparagraph",title:"插入段落",isEnable:!0,click:function(n){var i=e.curEditor,r=i.getCursorElement(),o=t(r).closest("p,pre,table,ul,ol,div"),a=i.dom.createElement("p");a.innerHTML="&#8203;",o[n](a),e.utils.setCursor(i.win,a,!0)}})}(jQuery.jQEditor,jQuery),function(e){e.addPlugin({id:"inserttime",click:function(){var t=new Date,n=t.getHours(),i=t.getMinutes(),r=t.getSeconds();n=n>9?n:"0"+n,i=i>9?i:"0"+i,r=r>9?r:"0"+r;var o='<h1>rst</h1>				<p>					<b>opq</b><span id="a">uvw<em id="c">ABC</em>xyz</span>				</p>				<ul>					<li id="b">a<strong style="background-color:#00000000;">bc</strong><sub>de</sub>fg</li>					<li>h<h2>ij</h2><h3>klm</h3>n</li>				</ul>';e.command("insert",o)}})}(window.jQuery.jQEditor),function(e,t){e.addPlugin({id:"link",type:"dialog",showDialog:function(n){e.utils.loadDialog(this.id);var i=n.Eid;e.dialog.open({id:"linkdialog",editor:i,title:"添加超链接",content:'<TABLE>					  <TR>						<TD>链接文字</TD>						<TD><input type="text" name="text" id="text" /></TD>					  </TR>					  <TR>						<TD>链接地址</TD>						<TD><input type="text" name="link" id="link" value="http://"/></TD>					  </TR>					  <TR>						<TD>打开容器</TD>						<TD><select  name="target" id="target">							<option value="_blank" selected="selected">新窗口</option>							<option value="_top">当前窗口</option>						</select></TD>					  </TR>					  </TABLE>',ok:function(){e.command("linkdialog")},cancel:function(){e.dialog.close("linkdialog")},init:function(){t("#text").val(e.utils.getSelectionText())},icon:"succeed"})}})}(window.jQuery.jQEditor,window.jQuery),function(e){var t=null;e.addPlugin({id:"map",type:"dialog",showDialog:function(n){e.utils.loadDialog(this.id);var i=n.Eid;e.dialog.open({id:"mapdialog",editor:i,title:"插入地图",content:'<iframe src="'+e.config.rootDir+'/src/core/ui/map/googlemap.htm" name="googlemapframe" style="width: 600px; height: 350px; border: 0px none;" frameborder="0" allowtransparency="true"></iframe>',ok:function(){e.command("mapdialog","submit",t)},cancel:function(){e.dialog.close("mapdialog")},init:function(){t=window.frames.googlemapframe},icon:"succeed"})}})}(window.jQuery.jQEditor),function(e){e.addPlugin({id:"olmenu",type:"panel",isEnable:!0,fill:function(t){var n="",i=[{name:"1.2.3...",cmd:"insertorderedlist",param:"decimal"},{name:"a,b,c...",cmd:"insertorderedlist",param:"lower-alpha"},{name:"A,B,C...",cmd:"insertorderedlist",param:"upper-alpha"},{name:"i,ii,iii...",cmd:"insertorderedlist",param:"lower-roman"},{name:"I,II,III...",cmd:"insertorderedlist",param:"upper-roman"}];n=e.Menu.create(i),e.fillPanel("insertorderedlistmenu",n,t)}})}(window.jQuery.jQEditor),function(e,t){e.addPlugin({id:"paste",isEnable:!0,click:function(){window.clipboardData?e.curEditor.dom.execCommand("paste"):e.errorMessage("请使用 Ctrl+v 进行粘贴")},cut:function(){e.IE?e.curEditor.dom.execCommand("cut"):e.errorMessage("请使用 Ctrl+x 进行剪切")},copy:function(){e.IE?e.curEditor.dom.execCommand("copy"):e.errorMessage("请使用 Ctrl+c 进行复制")},paste:function(){return e.utils.getBoardContent(e.curEditor,function(n){var i="";i=e.curEditor.isPastetotext?t(n).text():e.utils.filterInner(e.curEditor,n.innerHTML),e.command("insert",i)}),e.IE?!1:void 0},toggleTextpaste:function(){var t=e.curEditor.isPastetotext=!e.curEditor.isPastetotext;this.clicked(t,"pastetotext")}})}(window.jQuery.jQEditor,window.jQuery),function(e){e.addPlugin({id:"pasteword",type:"dialog",showDialog:function(t){e.utils.loadDialog(this.id);var n=t.Eid;e.dialog.open({id:"pasteworddialog",editor:n,title:"从Word粘贴",content:'<TABLE>						<TR>							<TD>							<p>请将Word当中的内容粘贴到下面的方框里，然后点击确定按钮。</p>							<textarea id="content" name="content" rows="20" cols="75">这是一个测试</textarea></TD>						</TR>						</TABLE>',ok:function(){e.dialog.close("pasteworddialog")},cancel:function(){e.dialog.close("pasteworddialog")},icon:"succeed"})}})}(window.jQuery.jQEditor),function(e){function t(n){if(this.ui="",n){for(var i in n)this[i]=n[i];t.allList[this.id].title=e.getLang(this.id),t.allList[this.id].isEnable=this.isEnable,this.htmlCmd=t.allList[this.id].htmlCmd;for(var r in e.editorList)e.editorList[r].pluginEnable[this.id]===void 0&&(e.editorList[r].pluginEnable[this.id]=this.isEnable);this.fill()}}function n(n){function i(e){t.call(this,e)}if(n.id){var r=n.id;i.prototype=l,e.pluginList[r]=new i(n),e.trigger("afterPlugin")}}var i=e.config.cCommand,r={};for(var o in i.pluginCommand){var a=i.pluginCommand[o];r[a.cmd]={htmlCmd:o,isEnable:!0,scriptAddr:e.config.cPlugin.addr+a.cmd+".plugin.js"}}e.loadPlugin=function(t,n){var i=r[t].scriptAddr;r[t].click===void 0?e.load.loadOneFile(i,function(){n()}):n()},t.allList=r,e.configPlugin=function(n){try{var i={};for(var r in t.allList)i[r]="undefined"===t.allList[r].isEnable?t.allList[r].isEnable:!0;for(var o=n.cPlugin.blackList,a=n.cPlugin.whiteList,l=o.length,s=a.length,c=0;l>c;c++)i[o[c]]=!1;for(var c=0;s>c;c++)i[a[c]]=!0;return i}catch(d){e.error.writeError("plugin config error: "+d.message,3,"plugin")}},t.prototype={initPlugin:function(){},click:function(){"panel"===this.type?e.toolbar.togglePanel(this.htmlCmd):"dialog"===this.type&&this.showDialog&&this.showDialog(e.curEditor)},getData:function(){return{}},showDialog:function(t){var n=this;e.dialog.open({id:n.ui,editor:t.Eid,title:n.title,content:e.uiList[n.ui].getHtml(),ok:function(){return n.check()?(e.dialog.revertSelection(n.id),e.command(n.ui),void 0):!1},cancel:function(){e.dialog.revertSelection(n.id),e.dialog.close(n.id)}},n.getData(t))},check:function(){return!0},fill:function(){},enable:function(t){t||(t=e.curEditor),t.pluginEnable[this.id]=!0},disable:function(t){t||(t=e.curEditor),t.pluginEnable[this.id]=!1},getTitle:function(){return e.lang.pluginTitle[this.title]},writeLog:function(t){var n="The operate "+t+" !",i="plugin",r=new Date,o=r.toLocaleString();e.log.writeLog(n,i,o)},writeError:function(t,n){var i="The operate "+t+" error !",r="plugin",o=new Date,a=o.toLocaleString();e.error.writeError(i,n,r,a)},showTips:function(t){var n="";t||(t=this.tips),n=e.lang.pluginTips[t]?e.lang.pluginTips[t]:t,e.utils.showTips(n)},loadUiTpl:function(t){e.utils.loadDialog(this.id,e.config.cUi.addr+this.id+"/",t)},clicked:function(t,n){n=n||this.id;var i=$("#"+e.curId).find(".bke-toolbar");i.find("#icon-"+n).closest(".bke-btn")[t?"addClass":"removeClass"]("bke-clicked")}};var l=new t;l.initPlugin(),n.ready=!0,e.addPlugin=n,e.plugin=function(t){return e.pluginList[t]}}(window.jQuery.jQEditor),function(e){e.addPlugin({id:"redo",isEnable:!0,click:function(){try{e.curEditor.baseHistory.redo()}catch(t){this.writeError("redo",2)}}})}(window.jQuery.jQEditor),function(e){e.addPlugin({id:"revert",isEnable:!0,click:function(){try{e.curEditor.baseHistory.revert()}catch(t){this.writeError("revert",2)}}})}(window.jQuery.jQEditor),function(e){e.addPlugin({id:"selectall",title:"清空文档",isEnable:!0,click:function(){e.curEditor.selectAll()}})}(jQuery.jQEditor,jQuery),function(e,t){function n(n){n=n.replace(/\n+/g,"");var i=t("<div></div>").append(n),r="",o=null;i.children().each(function(){try{o=t(this),r=o.html(),r.length>50&&o.html("\n"+r+"\n"),o.after("\n")}catch(e){}});var a=i.find("table");return a.size()&&a.find("tr,td,th").after("\n").before("\n"),n=i.html(),n=n.replace(/\n+/g,"\n"),n=n.replace(/<BR>/gi,"<br>\n"),n=n.replace(/<.+?>/gi,function(e){return e=e.replace(/COLOR:/g,"color:"),e=e.replace(/rgb\(\d+,(?: |&nbsp;)?\d+,(?: |&nbsp;)?\d+\)/gi,function(e){return Utils.colorToHex(e)})}),e.IE&&(n=n.replace(/<(\w+)/gi,function(e,t){return"<"+t.toLowerCase()}),n=n.replace(/(\w+)>/gi,function(e,t){return t.toLowerCase()+">"})),n}var i="";e.addUi({id:"sourcedialog",html:'<textarea name="content" style="width:700px;height:400px;resize:none;"></textarea>',submit:function(){var n=t("#sourcedialog").find("textarea").val();e.curEditor.setContent(n),i&&e.utils.setSelectionByOffset(e.editWin,i),i=""}}),e.addPlugin({id:"source",title:"源代码",ui:"sourcedialog",type:"dialog",getData:function(t){i=e.utils.getSelectionOffset(t.win);var r={content:n(t.getContent())};return r}})}(jQuery.jQEditor,jQuery),function(e){var t=[{name:"0px",cmd:"spacebottom",param:"0px",styleName:""},{name:"5px",cmd:"spacebottom",param:"5px",styleName:""},{name:"10px",cmd:"spacebottom",param:"10px",styleName:""},{name:"15px",cmd:"spacebottom",param:"15px",styleName:""},{name:"20px",cmd:"spacebottom",param:"20px",styleName:""}],n=[{name:"0px",cmd:"spacetop",param:"0px",styleName:""},{name:"5px",cmd:"spacetop",param:"5px",styleName:""},{name:"10px",cmd:"spacetop",param:"10px",styleName:""},{name:"15px",cmd:"spacetop",param:"15px",styleName:""},{name:"20px",cmd:"spacetop",param:"20px",styleName:""}],i=[{name:"0行距",cmd:"linespace",param:"1em",styleName:""},{name:"0.5倍行距",cmd:"linespace",param:"1.5em",styleName:""},{name:"单倍行距",cmd:"linespace",param:"2em",styleName:""},{name:"1.25倍行距",cmd:"linespace",param:"2.25em",styleName:""},{name:"1.5倍行距",cmd:"linespace",param:"2.5em",styleName:""},{name:"1.75倍行距",cmd:"linespace",param:"2.75em",styleName:""},{name:"2倍行距",cmd:"linespace",param:"3em",styleName:""},{name:"3倍行距",cmd:"linespace",param:"4em",styleName:""}];e.addPlugin({id:"spacemenu",type:"panel",isEnable:!0,fill:function(){var r=e.Menu.create(n),o=e.Menu.create(t),a=e.Menu.create(i);e.fillPanel("spacebottommenu",o),e.fillPanel("spacetopmenu",r),e.fillPanel("linespacemenu",a)},bottom:function(){e.toolbar.togglePanel("spacebottommenu")},top:function(){e.toolbar.togglePanel("spacetopmenu")},line:function(){e.toolbar.togglePanel("linespacemenu")}})}(window.jQuery.jQEditor),function(e){function t(){for(var e="<table>",t=0;n.length>t;t++){var i=n[t];e+="<tr>";for(var r=0;i.length>r;r++)e+='<td><a href="javascript:void(0)" cmd="spechars" param="'+i[r]+'"'+' class="special_num">'+i[r]+"</a></td>";e+="</tr>"}return e+="</table>"}var n=[["±","×","÷","∶","∑","∏","∪","∩","∈","∷"],["√","⊥","∥","∠","⌒","∫","∮","≡","≌","≈"],["∝","≠","≮","≯","≤","≥","∞","∵","∴","㏑"],["㏒"],["＄","￠","￡","㏎","㎎","㎏","㎜","㎝","㎞","㎡"],["㏄","㏕","№"],["ā","á","ǎ","à","ē","é","ě","è","ī","í"],["ǐ","ì","ō","ó","ǒ","ò","ū","ú","ǔ","ù"],["ǖ","ǘ","ǚ","ǜ","ü"]];
e.addPlugin({id:"specharsmenu",type:"panel",fill:function(){e.fillPanel("specharsmenu",t())},click:function(){e.toolbar.togglePanel("specharsmenu")}})}(jQuery.jQEditor,jQuery),function(e,t){function n(n){return n?t(e.editDom).find(n).find("."+e.curEditor.config.selectCellClass):t(e.editDom).find("."+e.curEditor.config.selectCellClass)}function i(){return t(e.utils.getCurElement().pop()).closest("td,th")}function r(){var n=t(e.editDom).find("."+e.curEditor.config.selectTableClass);return n.length>0?n:t(e.utils.getCurElement().pop()).closest("table")}function o(e){var r={curTable:e,startCol:-1,endCol:-1,startRow:-1,endRow:-1},o=n(e);if(0!==o.length){var a=t(o[0]),l=t(o[o.length-1]);r.startCol=parseInt(a.attr("col")),r.startRow=parseInt(a.attr("row")),r.endCol=parseInt(l.attr("col")),r.endRow=parseInt(l.attr("row"));var s=l.attr("colspan")?parseInt(l.attr("colspan")):1,c=l.attr("rowspan")?parseInt(l.attr("rowspan")):1;r.endCol+=s-1,r.endRow+=c-1}else{o=t(i()),r.startCol=parseInt(o.attr("col")),r.startRow=parseInt(o.attr("row"));var s=o.attr("colspan")?parseInt(o.attr("colspan")):1,c=o.attr("rowspan")?parseInt(o.attr("rowspan")):1;r.endCol=r.startCol+s-1,r.endRow=r.startRow+c-1}return r.curTable=o.closest("table"),r}e.addPlugin({id:"table",type:"dialog",selectCellClass:"bke-cell-selected",selectTableClass:"bke-table-selected",tableFreshed:"",showDialog:function(n){e.utils.loadDialog(this.id,e.config.cUi.addr+"table/",function(){var i=n?n.Eid:e.curEditor.Eid;e.dialog.open({id:"tabledialog",editor:i,title:"插入表格",content:t("[ui=tabledialog]"),ok:function(){e.command("tabledialog")},cancel:function(){e.dialog.close("tabledialog")},icon:"succeed"})})},insert:function(t){var n=t.split("-"),i={row:n[0],col:n[1],floatStyle:"",head:0,title:""},r=this.getTableHtml(i);e.coreCommand.editInsert(r)},getTableHtml:function(e){var t=50>parseInt(e.row)?parseInt(e.row):4,n=20>parseInt(e.col)?parseInt(e.col):3,i="";i=e.floatStyle?" table-"+e.floatStyle:"";var r='<table class="table '+i+'" border="1" cellpadding="0" border-style="solid" width="95%"><tbody>';e.title&&(r+="<caption>&#8203;<br></caption>");for(var o=0;t>o;o++){r+="<tr>";for(var a=0;n>a;a++)r+=e.head&&0===o?'<th row="'+o+'" col="'+a+'">&#8203;<br></th>':'<td row="'+o+'" col="'+a+'">&#8203;<br></td>';r+="</tr>"}return r+="</tbody></table>"},preInsert:function(n){var i=e.editDom.createElement("table"),r=50>parseInt(n.row)?parseInt(n.row):4,o=20>parseInt(n.col)?parseInt(n.col):3,a=4>parseInt(n.float)?parseInt(n.float):2,l=n.title?!0:!1,s=n.head?!0:!1;t(i).attr({border:1,Cellpadding:0,"border-style":"solid"}),t(i).width("100%"),l&&t(i).prepend("<caption>title</caption>");for(var c=0;r>c;c++){t(i).append("<tr></tr>");for(var d=0;o>d;d++){var u=t(i).find("tr:eq("+c+")");s&&0===c?u.append("<th row="+c+" col="+d+">&#8203;<br></th>"):u.append("<td row="+c+" col="+d+">&#8203;<br></td>")}}var f="";switch(a){case 1:f="left";break;case 2:f="none";break;case 3:f="right";break;default:f="none"}return t(i).css("float",f),i.outerHTML},insertRow:function(n){this.freshTableIndex(r());for(var i=o(),a=t(i.curTable).find("tr").first().find("th,td").length,l={},s={},c={},d=i.startRow;i.endRow>=d;d++){var u=e.editDom.createElement("tr"),f={},m=0;if("forward"===n){l=t(i.curTable).find("tr:eq("+d+")");for(var p=0;a>p;p++)c=l.find("td,th").eq(p),f=this._cloneRowCell(c,n,m),s=f.cloneCell,m=f.hideCells?f.hideCells:m-1,t(u).append(s);l.before(t(u))}else if("backward"===n){l=t(i.curTable).find("tr:eq("+i.endRow+")");for(var p=0;a>p;p++)c=l.find("td,th").eq(p),f=this._cloneRowCell(c,n,m),s=f.cloneCell,m=f.hideCells?f.hideCells:m-1,t(u).append(s);l.after(t(u))}else e.errorMessage("参数错误")}this.freshTableIndex(i.curTable,!0)},insertCol:function(n){this.freshTableIndex(r());for(var i=o(),a=t(i.curTable).find("tr").length,l={},s={},c={},d={},u=0,f=0;a>f;f++){s=t(i.curTable).find("tr:eq("+f+")");for(var m=i.startCol;i.endCol>=m;m++)"forward"===n?(l=s.find("td,th").eq(m),d=this._cloneColCell(l,n,u),c=d.cloneCell,l.before(c)):"backward"===n?(l=s.find("td,th").eq(i.endCol),d=this._cloneColCell(l,n,u),c=d.cloneCell,l.after(c)):e.errorMessage("参数错误");u=d.hideCells?d.hideCells:u-1}this.freshTableIndex(i.curTable,!0)},combineCell:function(){this.freshTableIndex(r());var i=n(),o=i.length;if(o>1){var a=t(i[o-1]).attr("colspan")?parseInt(t(i[o-1]).attr("colspan")):1,l=t(i[o-1]).attr("rowspan")?parseInt(t(i[o-1]).attr("rowspan")):1,s=parseInt(t(i[o-1]).attr("row"))-parseInt(t(i[0]).attr("row")),c=parseInt(t(i[o-1]).attr("col"))-parseInt(t(i[0]).attr("col"));t(i[0]).attr("colspan",c+a),t(i[0]).attr("rowspan",s+l),i.not(i[0]).hide(),i.not(i[0]).attr("rowspan",1).attr("colspan",1),i.not(i[0]).removeClass(e.curEditor.config.selectCellClass)}},combineColAfter:function(n){this.freshTableIndex(r());var o=i();if(o.length>0){var a=t(o[0]).attr("rowspan")?parseInt(t(o[0]).attr("rowspan")):1,l=t(o[0]).attr("colspan")?parseInt(t(o[0]).attr("colspan")):1,s=t(o[0]).nextAll("td,th").eq(l-1).not(":hidden");if(s.length>0){var c=s.attr("rowspan")?parseInt(s.attr("rowspan")):1,d=s.attr("colspan")?parseInt(s.attr("colspan")):1;if(a===c){if(n)return!0;s.attr("colspan","1").attr("rowspan","1").hide(),o.attr("colspan",l+d)}else{if(n)return!1;e.errorMessage("合并失败，单元格行跨度不一致")}}else{if(n)return!1;e.errorMessage("没有单元格可以合并")}}},combineRowAfter:function(n){this.freshTableIndex(r());var o=i();if(o.length>0){var a=t(o[0]).attr("rowspan")?parseInt(t(o[0]).attr("rowspan")):1,l=t(o[0]).attr("colspan")?parseInt(t(o[0]).attr("colspan")):1,s=parseInt(t(o[0]).attr("col")),c=t(o[0]).closest("tr").nextAll("tr:eq("+(a-1)+")").first().find("td[col="+s+"]:visible,th[col="+s+"]:visible");if(c.length>0){var d=c.attr("rowspan")?parseInt(c.attr("rowspan")):1,u=c.attr("colspan")?parseInt(c.attr("colspan")):1;if(u===l){if(n)return!0;c.attr("colspan","1").attr("rowspan","1").hide(),o.attr("rowspan",a+d)}else{if(n)return!1;e.errorMessage("合并失败，单元格列跨度不一致")}}else{if(n)return!1;e.errorMessage("没有单元格可以合并")}}},splitCellWhole:function(n){this.freshTableIndex(r());var o="object"==typeof n?t(n):i();if(o.length>0){var a=t(o[0]).attr("rowspan")?parseInt(t(o[0]).attr("rowspan")):1,l=t(o[0]).attr("colspan")?parseInt(t(o[0]).attr("colspan")):1,s=parseInt(t(o[0]).attr("col")),c=t(o[0]).closest("tr").nextAll("tr:lt("+(a-1)+")").andSelf().find("td:lt("+(s+l)+"):gt("+(s-1)+"),th:lt("+(s+l)+"):gt("+(s-1)+")").not(":visible");c.length>0?(o.attr("colspan","1").attr("rowspan","1").addClass(e.curEditor.config.selectCellClass),c.attr("colspan","1").attr("rowspan","1").addClass(e.curEditor.config.selectCellClass).show()):e.errorMessage("没有单元格供拆分")}},splitToRows:function(n){this.freshTableIndex(r());var o="object"==typeof n?t(n):i();if(o.length>0){var a=t(o[0]).attr("rowspan")?parseInt(t(o[0]).attr("rowspan")):1,l=t(o[0]).attr("colspan")?parseInt(t(o[0]).attr("colspan")):1,s=parseInt(t(o[0]).attr("col")),c=t(o[0]).closest("tr").nextAll("tr:lt("+(a-1)+")").find("td[col="+s+"]:hidden,th[col="+s+"]:hidden");c.length>0?(o.attr("rowspan","1").addClass(e.curEditor.config.selectCellClass),l>1&&c.attr("colspan",l),c.attr("rowspan","1").addClass(e.curEditor.config.selectCellClass).show()):e.errorMessage("没有行单元格供拆分")}},splitToCols:function(n){this.freshTableIndex(r());var o="object"==typeof n?t(n):i();if(o.length>0){var a=t(o[0]).attr("rowspan")?parseInt(t(o[0]).attr("rowspan")):1,l=t(o[0]).attr("colspan")?parseInt(t(o[0]).attr("colspan")):1,s=t(o[0]).nextAll("td:lt("+(l-1)+"),th:lt("+(l-1)+")").not(":visible");s.length>0?(o.attr("colspan","1").addClass(e.curEditor.config.selectCellClass),a>1&&s.attr("rowspan",a),s.attr("colspan","1").addClass(e.curEditor.config.selectCellClass).show()):e.errorMessage("没有列单元格供拆分")}},deleteCol:function(){this.freshTableIndex(r());for(var e=o(),n=t(e.curTable).find("tr").first().find("th,td").length,i={},a={},l=e.endRow;l>=e.startRow;l--){i=t(e.curTable).find("tr:eq("+l+")");for(var s=n-1;s>=0;s--){a=i.find("td,th").eq(s);var c=this._colInfo(a);if(0>c.isInCol&&c.lastRowspan>1)if(0===c.isInCol+c.lastRowspan){var d=i.next("tr").find("[col="+s+"]");d.attr("rowspan",c.lastRowspan-1).show()}else c.lastVisibleCell.attr("rowspan",c.lastRowspan-1);a.remove()}i.remove()}this.freshTableIndex(e.curTable,!0)},deleteRow:function(){this.freshTableIndex(r());for(var e=o(),n=t(e.curTable).find("tr").length,i={},a={},l=n-1;l>=0;l--){a=t(e.curTable).find("tr:eq("+l+")");for(var s=e.endCol;s>=e.startCol;s--){i=a.find("td,th").eq(s);var c=this._rowInfo(i);if(0>c.isInRow&&c.lastColspan>1)if(0===c.isInRow+c.lastColspan){var d=i.next("td,th");d.attr("colspan",c.lastColspan-1).html("del").show()}else c.lastVisibleCell.attr("colspan",c.lastColspan-1);i.remove()}}this.freshTableIndex(e.curTable,!0)},deleteTable:function(){var e=r();t(e).remove()},tableAttrDialog:function(){e.utils.loadDialog(this.id,e.config.cUi.addr+"table/",function(){var n=r(),i={};switch(n.css("float")){case"left":i.float=1;break;case"none":i.float=2;break;case"right":i.float=3;break;default:i.float=2}var o=n.find("th").length;i.head=o?!0:!1;var a=n.find("caption:first-child").length;i.title=a?!0:!1;var l=n.find("tr").length;i.row=l?l:!1;var s=n.find("tr:first").find("th,td").length;i.col=s?s:!1;var c=e.curEditor.Eid;e.dialog.open({id:"tableattrdialog",editor:c,ui:"tabledialog",title:"表格属性",content:t("[ui=tabledialog]"),ok:function(){e.command("tabledialog","changeAttr")},cancel:function(){e.dialog.close("tabledialog")},icon:"succeed"},i)})},freshTableIndex:function(n,i){if(this.tableFreshed!==t(n)[0]||i===!0){var r=e.utils.getSelectionRange(e.editWin,"node"),o=n?t(n):t(e.editDom).find("table");o.each(function(){var e=[],n=0,i=0,r=0;t(this).find("td:hidden,th:hidden").remove();var o=t(this).find("tr");o.each(function(){var o=t(this).find("td,th");e[i]===void 0&&(e[i]=[]),o.each(function(){for(var r=t(this).attr("colspan")?parseInt(t(this).attr("colspan")):1,o=t(this).attr("rowspan")?parseInt(t(this).attr("rowspan")):1,a=n;e[i][a]!==void 0;)a+=1;if(e[i][a]=t(this),r>1||o>1){for(;r>1;){var l=t(this).clone(!0);l.attr("colspan","1").attr("rowspan","1"),l.html(" ").hide(),e[i][a+r-1]=l;for(var s=o;s>1;){var c=t(this).clone(!0);c.attr("colspan","1").attr("rowspan","1"),c.html(" ").hide(),e[i+s-1]===void 0&&(e[i+s-1]=[]),e[i+s-1][a+r-1]=c,s-=1}r-=1,t(this).after(l)}for(;o>1;){var c=t(this).clone(!0);c.attr("colspan","1").attr("rowspan","1"),c.html(" ").hide(),e[i+o-1]===void 0&&(e[i+o-1]=[]),e[i+o-1][a]=c,o-=1}}n+=1}),r=Math.max(r,e[i].length),i+=1,n=0});for(var a=e.length,l=t(this).find("tr").length;a>l;)t(this).append("<tr></tr>"),l+=1;for(var s=0;a>s;s++)for(var c=Math.max(r,e[s].length),d=t(this).find("tr:eq("+s+")"),u=0;c>u;u++)e[s][u]===void 0&&(e[s][u]=t('<td row="'+s+'" col="'+u+'"></td>')),e[s][u].attr("row",s).attr("col",u),d.append(e[s][u])}),e.utils.setSelectionRange(e.editWin,r,"node"),this.tableFreshed=n?t(n)[0]:""}},changeTableAttr:function(n){var i=r(),o=4>parseInt(n.float)?parseInt(n.float):2,a=n.title?!0:!1,l=n.head?!0:!1;if(a&&0===t(i).find("caption:first-child").length?t(i).prepend("<caption>title</caption>"):a||0===t(i).find("caption:first-child").length||t(i).find("caption:first-child").remove(),l&&0===t(i).find("tr:first").find("th").length){for(var s=t(i).find("tr:first").find("td").length,c=e.editDom.createElement("tr"),d=0;s>d;d++)t(c).append("<th>head</th>");t(i).find("tr:first").before(c),this.freshTableIndex(i,!0)}else l||0===t(i).find("tr:first").find("th").length||(t(i).find("tr:first").remove(),this.freshTableIndex(i,!0));var u="";switch(o){case 1:u="left";break;case 2:u="none";break;case 3:u="right";break;default:u="none"}t(i).css("float",u)},cellJustify:function(e){var r="",o="";switch(e=parseInt(e)){case 1:r="left",o="top";break;case 2:r="center",o="top";break;case 3:r="right",o="top";break;case 4:r="left",o="middle";break;case 5:r="center",o="middle";break;case 6:r="right",o="middle";break;case 7:r="left",o="bottom";break;case 8:r="center",o="bottom";break;case 9:r="right",o="bottom";break;default:r="center",o="middle"}var a=n();(0!==t(a).length||(a=i(),0!==t(a).length))&&(t(a).css("text-align",r),t(a).css("vertical-align",o))},cellColor:function(n){var i=t(e.editDom).find("body table ."+e.curEditor.config.selectCellClass);0===i.length&&(i=t(e.utils.getCurElement().pop()).closest("td,th")),i.css("background-color",n)},tableFloat:function(e){var n="";switch(e=parseInt(e)){case 1:n="left";break;case 2:n="none";break;case 3:n="right";break;default:n="none"}var i=r();t(i).css("float",n)},_cloneRowCell:function(t,n,i){var r={},o=t.clone().html("newcell"),a="forward"===n?!0:!1,l=this._rowInfo(t);if(0>l.isInRow)!a&&l.addRowspan>1?(o.hide(),0===l.isInRow+l.lastColspan&&l.lastVisibleCell.attr("rowspan",l.addRowspan+1)):o.show();else{var s=this._colInfo(t);0>s.isInCol?s.lastRowspan>1?!a&&-1>s.isInCol||a&&s.isInCol+s.lastRowspan>0?(o.hide(),r.hideCells=s.addColspan,s.lastVisibleCell.attr("rowspan",s.lastRowspan+1)):o.show():o.show():i>0?o.hide():o.show()}return o.removeClass(e.curEditor.config.selectCellClass),o.attr("colspan",1).attr("rowspan",1),o.attr("col",-1).attr("row",-1),r.cloneCell=o,r},_cloneColCell:function(t,n,i){var r={},o=t.clone().html("NEWCELL"),a="forward"===n?!0:!1,l=this._colInfo(t);if(0>l.isInCol)!a&&l.addColspan>1?(o.hide(),0===l.isInCol+l.lastRowspan&&l.lastVisibleCell.attr("colspan",l.addColspan+1)):o.show();else{var s=this._rowInfo(t);0>s.isInRow?s.lastColspan>1?!a&&-1>s.isInRow||a&&s.isInRow+s.lastColspan>0?(o.hide(),r.hideCells=s.addRowspan,s.lastVisibleCell.attr("colspan",s.lastColspan+1)):o.show():o.show():i>0?o.hide():o.show()}return o.removeClass(e.curEditor.config.selectCellClass),o.attr("colspan",1).attr("rowspan",1),o.attr("col",-1).attr("row",-1),r.cloneCell=o,r},_rowInfo:function(e){var t={};t=0!==e.not(":visible").length?e.prevAll(":visible").first():e;var n=0===t.length?-1:parseInt(t.attr("col")),i=t.attr("colspan")?parseInt(t.attr("colspan")):1,r=t.attr("rowspan")?parseInt(t.attr("rowspan")):1,o=parseInt(e.attr("col"))-n-i;return{isInRow:o,lastColspan:i,addRowspan:r,lastVisibleCell:t}},_colInfo:function(e){var t={};t=0!==e.not(":visible").length?e.closest("table").find("[col="+parseInt(e.attr("col"))+"]:lt("+parseInt(e.attr("row"))+")").not(":hidden").last():e;var n=0===t.length?-1:parseInt(t.attr("row")),i=t.attr("rowspan")?parseInt(t.attr("rowspan")):1,r=t.attr("colspan")?parseInt(t.attr("colspan")):1,o=parseInt(e.attr("row"))-n-i;return{isInCol:o,lastRowspan:i,addColspan:r,lastVisibleCell:t}}})}(window.jQuery.jQEditor,window.jQuery),function(e,t){function n(n,i){var r=document.createElement("div"),o=document.createElement("table");t(o).addClass("bke-plugin-table");for(var a=0;n>a;a++){t(o).append("<tr></tr>");for(var l=0;i>l;l++){var s=t(o).find("tr:eq("+a+")");s.append('<td args="'+(a+1)+"-"+(l+1)+'" cmd="inserttable" param="insert"><a></a></td>')}}return e.Menu.create([{name:"插入表格",cmd:"inserttable",param:"showDialog"}]),t(r).append('<div class="bke-info">0行 0列</div>'),t(r).append(o),r.innerHTML}e.addPlugin({id:"tablemenu",type:"panel",isEnable:!0,fill:function(){e.fillPanel("inserttablemenu",n(10,10)),t(document).delegate(".bke-plugin-table td","mouseenter",function(e){var n=t(e.target).closest("td[args]").attr("args").split("-"),i=parseInt(n[0]),r=parseInt(n[1]),o=t(e.target).closest(".bke-plugin-table");o.parent().children(".bke-info").text(n[0]+"行 "+n[1]+"列"),o.find("td").removeClass("cell-hover"),o.find("tr:lt("+i+")").find("td:lt("+r+")").addClass("cell-hover")}).delegate(".bke-plugin-table","mouseleave",function(e){var n=t(e.target).closest(".bke-plugin-table");n.parent().children(".bke-info").text("0行 0列"),n.find("td").removeClass("cell-hover")})},getTablePanel:function(){return n(10,10)}})}(jQuery.jQEditor,jQuery),function(e){e.addPlugin({id:"ulmenu",type:"panel",isEnable:!0,fill:function(t){var n="",i=[{name:"小圆圈",cmd:"insertunorderedlist",param:"disc"},{name:"小圆点",cmd:"insertunorderedlist",param:"circle"},{name:"小方块",cmd:"insertunorderedlist",param:"square"}];n=e.Menu.create(i),e.fillPanel("insertunorderedlistmenu",n,t)}})}(window.jQuery.jQEditor),function(e){e.addPlugin({id:"video",type:"dialog",showDialog:function(t){e.utils.loadDialog(this.id);var n=t.Eid;e.dialog.open({id:"videodialog",editor:n,title:"插入视频",content:'<TABLE>						  <TR>							<TD>视频地址</TD>							<TD><input type="text" id="src" name="src" value="http://player.youku.com/player.php/sid/XNTA5MjczMDA0/v.swf" /></TD>						  </TR>						  <TR>							<TD>宽</TD>							<TD><input type="text" id="width" name="width" value="800"/></TD>						  </TR>						  <TR>							<TD>高</TD>							<TD><input type="text" id="height" name="height" value="600" /></TD>						  </TR>						  </TABLE>',ok:function(){e.command("videodialog")},cancel:function(){e.dialog.close("videodialog")},icon:"succeed"})}})}(window.jQuery.jQEditor);